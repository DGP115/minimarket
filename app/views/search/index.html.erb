<%= render "search/form" %>

<div class="mb-2 text-base font-bold text-center text-indigo-700">
  <%=pluralize(@products.count, "Search Result") %>
</div>

<% if @products.any? %>

  <div class="p-2 overflow-x-auto border rounded-md bg-indigo-50 border-stone-400 md:max-w-3/4 md:mx-auto">
    <div class="mb-2 grid grid-cols-[3rem_minmax(0,1fr)_minmax(0,1fr)_minmax(0,1fr)] 
                          md:grid-cols-[3rem_12rem_minmax(0,1fr)_6rem] gap-x-2 gap-y-2 font-semibold text-sm min-w-0">

      <!-- Header Row -->
      <div class="min-w-0 text-left truncate md:px-2">Item</div>
      <div class="min-w-0 text-left text-blue-500 underline truncate md:px-6">
        <%= sort_link(@query, :product_category_name, "Category", default_order: :asc) %>
      </div>
      <!-- Title cell: min-w-0 + truncate so ellipsis works inside grid -->
      <div class="min-w-0 text-left text-blue-500 underline truncate md:px-6">
        <%= sort_link(@query, :title, "Title", default_order: :asc) %>
      </div>
      <div class="min-w-0 text-center text-blue-500 underline truncate">
        <%= sort_link(@query, :price, "Price", default_order: :asc) %>
      </div>


      <!-- Data Rows -->
      <% @products.each_with_index do |product, index| %>
        <div class="min-w-0 text-sm font-normal text-center truncate md:px-2"><%= index + 1 %></div>
        <div class="min-w-0 text-sm font-normal text-left truncate md:px-2">
          <%= link_to product.product_category.name, 
                      product_category_path(product.product_category), 
                      class: "hover:text-violet-500 hover:font-semibold"  %>
        </div>
        <div class="min-w-0 text-sm font-normal truncate md:px-2">
          <%= link_to product.title, product_path(product), 
                      class:"hover:text-violet-500 hover:font-semibold"  %>
        </div>
        <div class="min-w-0 text-sm font-normal text-right truncate md:px-2">
          <%= number_to_currency(product.price, precision: 2, unit: "$", delimiter: ",") %>
        </div>
      <% end %>
      
    </div>
  </div>
<% end %>